---
layout: post
title: MalwareTech Beginner Malware Reversing Challenges Strings2 Writeup
categories: Reversing
---

## Environment
* Host OS: Kali linux 2018.4
* Guest OS: Windows 7 Home Basic
* Virtualization: Virtualbox 5.2.22 
* Debugger: IDA Pro 7.0

## Explanation
We have several malware reversing challenges <a href="https://www.malwaretech.com/beginner-malware-reversing-challenges">this page</a> on MalwareTech<br>
This is a write-up of "Strings2".
{% highlight shell %}
strings2.exe contains an un-encrypted flag stored within the executable. When run, the program will output an MD5 hash of the flag but not the original. Can you extract the flag?
{% endhighlight %}

## Solution
### 1. Opening with IDA
When we open the strings2.exe with IDA, we can get following lots of variables.
![placeholder](https://media.githubusercontent.com/media/1n4r1/1n4r1.github.io/master/public/images/2019-02-12/2019-02-12-09-26-12.png)
Then, bunch of mov instructions are following.
![placeholder](https://media.githubusercontent.com/media/1n4r1/1n4r1.github.io/master/public/images/2019-02-12/2019-02-12-09-28-38.png)
Because there is "h" trailing, we can figure out these are hex numbers.

### 2. Translate hex to ascii
We can write a python script which translates there hex codes to ascii characters.
{% highlight shell %}
root@kali:~# cat strings2.py 
#! /usr/bin/python3

import binascii

HEX = '464C41477B535441434B2D535452494E47532D4152452D424553542D535452494E47537D'


def main():
    print(binascii.a2b_hex(HEX))


if __name__ == "__main__":
    main()
{% endhighlight %}

Let's execute the python script.<br>
We can grab the flag for this challenge.
{% highlight shell %}
root@kali:~# ./strings2.py 
b'FLAG{STACK-STRINGS-ARE-BEST-STRINGS}'
{% endhighlight %}
