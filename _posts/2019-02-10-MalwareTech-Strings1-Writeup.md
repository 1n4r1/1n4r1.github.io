---
layout: post
title: MalwareTech Beginner Malware Reversing Challenges Strings1 Writeup
---

## Environment
* Host OS: Kali linux 2018.4
* Guest OS: Windows 7 Home Basic
* Virtualization: Virtualbox 5.2.22 
* Debugger: IDA Pro 7.0

## Explanation
We have several malware reversing challenges <a href="https://www.malwaretech.com/beginner-malware-reversing-challenges">this page</a> on MalwareTech<br>
This is a write-up of "Strings1" on that website.
{% highlight shell %}
strings1.exe contains an un-encrypted flag stored within the executable. When run, the program will output an MD5 hash of the flag but not the original. Can you extract the flag?
{% endhighlight %}

## Solution
### 1. Opening with IDA
Sounds like we have to find an un-encrypted flag from one windows executable file strings1.exe.<br>
As written on the challenge web page, we don't need to run the executable.<br>
By opening with IDA, we can see the overal structure.<br>
![placeholder](https://inar1.github.io/public/images/2019-02-09-21-27-04.png)
To find a strings, we can go to Strings window.<br>
(View->Open Subviews->Strings or Shift+F12).
![placeholder](https://inar1.github.io/public/images/2019-02-09-22-03-05.png)
As we can see, we have too many numbers of possible flags.

### 2. Analysing assembly code
![placeholder](https://inar1.github.io/public/images/2018-12-29-11-09-39.png)
By reading the disassembly code, we can find that after a few lines of standard instructions, we have these instructions below.<br>
![placeholder](https://inar1.github.io/public/images/2019-02-09-21-55-30.png)
looks like it is hashing the characters in off_432294.<br>
By double clicking the operand, we can see the value of the address.
![placeholder](https://inar1.github.io/public/images/2019-02-09-22-00-16.png)
This is the flag which we have to find.
